# engine
该服务是数字交易所的撮合引擎，用于管理并撮合交易的订单。该引擎旨在演示撮合引擎的基础功能，以及版本变迁。特别提醒：该项目是一个实验性项目，请勿将其用于生产环境。
提供高性能、高可靠性和高灵活性，以满足不同类型的数字货币交易所的需求。

## 功能
该引擎的主要功能包括：
* 订单管理：支持订单的创建、撤销、查询等操作。
* 撮合引擎：支持订单的撮合，以实现买卖匹配和成交处理。
* API接口：提供 HTTP 和 RPC 接口，以便于客户端或上游服务接入。

## 设计
该服务的最终目标是单机撮合，多机存储，即通过一致性协议将订单簿放置在不同的机器分片中。
该引擎的设计考虑了以下几个方面：
* 系统架构：采用分布式架构，将不同功能划分为不同的服务，以提高可扩展性和可维护性。
* 数据库：采用传统的关系型数据库，以支持高并发的数据访问和数据一致性。
* 内存数据库：采用内存数据库，以支持高速的订单撮合。
* 代码质量：采用高质量的代码编写标准和自动化测试方法，以确保引擎的正确和可靠。
* 算法设计：在该项目设计过程中

## 设计思路
1. 撮合引擎本质上是一个按照规则排序匹配系统（orderbook）。用户下单后，首先从订单薄中查找是否有能与其匹配的委托单，如果有，则匹配成交；如果没有，则按照规则，将其加入带匹配列表中。
   所以，需要撮合引擎按照一定的规则对这些委托单做排序，通常我们需要将其按照**价格优先，时间次之**的规则排序，即优先按照价格排序，如果价格相同，则按照委托单时间排序。
   所以，我们需要一种数据结构来支持这个二维的匹配系统。该结构需要支持：增（添加订单），删（用户撤单/匹配成功），查（查找符合条件的委托单）。
   可选的数据结构有：二维链表，优先队列，红黑树等等。
   ![币安现货交易订单簿](assets/images/binance_spot_orderbook.png)
2. 通常，交易系统中交易服务（用户下单，撤单等功能）与撮合引擎是耦合在一起的，在该项目中，我将其做了拆分，仅保留了撮合引擎的逻辑。目的是为了使撮合引擎的功能更独立;
3. 单点故障问题，通过引入 [hashicorp/raft](https://github.com/hashicorp/raft) 来解决，由 leader 节点负责撮合工作。
   在该项目设计过程中，我进行了多次取舍，以兼顾性能、可维护性、易用性等方面的考虑。其中一些主要的取舍如下：

存储（本地） -> 定序 

## 性能测试

在该项目开发完成后，我们进行了多次性能测试，以评估该引擎的性能和稳定性。我们采用常见的测试用例，并在多个测试环境下进行了测试，包括：
* 低并发：模拟低并发，即少量用户同时进行交易的情况，测试结果表明，该引擎在低并发时表现良好，可以轻松处理订单撮合和成交处理。
* 中并发：模拟中等并发，即大量用户同时进行交易的情况，测试结果表明，该引擎在中等并发时仍能提供良好的性能和稳定性。
* 高并发：模拟高并发，即大量用户同时进行极端交易的情况，测试结果表明，该引擎在高并发时性能稍有下降，但仍能提供较高的稳定性和可靠性。

## 注意事项
* 该项目是实验性项目，尚未经过充分的生产环境测试和验证，因此不建议在生产环境下使用该项目。
* 该项目的开发和测试仍在持续进行中，可能存在未知的Bug和问题，请使用者谨慎评估风险并自行承担责任。
* 该项目的代码已经开源，在遵守开源许可证的前提下，欢迎开发者参与贡献和改进该项目。

## 安装
该引擎支持Linux和Windows系统，具体安装方法请参考安装文档。

## 使用
该引擎的使用方法，请参考使用文档。

## API接口
该引擎的API接口，请参考API文档。

## 开发
该引擎的开发方法，请参考开发文档。

## 贡献
欢迎提交代码贡献和问题反馈，请参考贡献指南。
